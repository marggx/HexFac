var ut=Object.defineProperty;var gt=(r,t,e)=>t in r?ut(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var o=(r,t,e)=>gt(r,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=e(i);fetch(i.href,n)}})();function dt(r,t){const e=Math.pow(10,t);return Math.round(r*e)/e}function E(r,t){const e=Math.pow(10,t);return Math.floor(r*e)/e}function pt(r){return r>0}class P{constructor(t,e,s,i=!0){o(this,"q");o(this,"r");o(this,"s");o(this,"id");o(this,"exists");if(Math.round(t+e+s)!==0)throw"q + r + s must be 0";this.q=t,this.r=e,this.s=s,this.id=t+"_"+e+"_"+s,this.exists=i}getPosition(){return{q:this.q,r:this.r,s:this.s}}}const ft="/HexFac/assets/grass_13-YbShMGaZ.png",xt="/HexFac/assets/grass_14-BX8rd9hq.png",yt="/HexFac/assets/grass_15-CF7sRd7j.png",mt="data:image/png;base64,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",St="/HexFac/assets/dirt_13--YxG2BSR.png",At="/HexFac/assets/dirt_14-BFJ4a5Jb.png",vt="data:image/png;base64,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",wt="/HexFac/assets/dirt_16-bRrLznJ8.png",Mt="/HexFac/assets/dirt_17-D9GoZj0H.png",bt="/HexFac/assets/Tree-BMZo7A7F.png",Ct={grass_13:ft,grass_14:xt,grass_15:yt,grass_16:mt,dirt_13:St,dirt_14:At,dirt_15:vt,dirt_16:wt,dirt_17:Mt,tree:bt};let z={};function It(r){if(z[r])return z[r];const t=Ct[r];if(!t)throw new Error(`Image ${r} not found`);const e=new Image;return e.src=t,e.onload=()=>{z[r]=e},e}class k extends P{constructor(e,s,i,n,a,h,l,u,c){super((s==null?void 0:s.q)??0,(s==null?void 0:s.r)??0,(s==null?void 0:s.s)??0);o(this,"type");o(this,"level");o(this,"image");o(this,"range");o(this,"conenctToSameType");o(this,"updateable",!1);o(this,"recipe");o(this,"placableOn");o(this,"publicStorage",new Map);o(this,"publicStorageChange",new Map);o(this,"publicStoragePS",new Map);o(this,"privateStorage",new Map);o(this,"isHighlighted",!1);this.type=e,this.image=It(i??"dirt_17"),this.level=n??1,this.range=a??0,this.conenctToSameType=h??!0,this.recipe=l,this.placableOn=u,l&&this.setRecipe(l),c&&(this.publicStorage=c)}setRecipe(e){this.recipe=e,this.updateable=!0,this.recipe.outputs.forEach(s=>{let i=s.clone();i.value=0,this.publicStorage.set(i.type,i)}),this.recipe.inputs.forEach(s=>{let i=s.clone();i.value=0,this.privateStorage.set(i.type,i)})}update(e,s){this.getRecipeInputFromNearbyBuildings(s),this.setStorageBasedOnRecipe(e)}setStorageBasedOnRecipe(e){var a;let s=!0;const i=this.recipe.inputs,n=this.recipe.outputs;for(let h=0;h<i.length;h++)if(((a=this.privateStorage.get(i[h].type))==null?void 0:a.value)>=i[h].value)s=!0;else{s=!1;break}if(!s){this.addDeltaToChange(0,e,null);return}for(let h=0;h<n.length;h++){let l=n[h],u=this.publicStorage.get(l.type);if(!u)continue;let c=e*l.value;u.value+=c,this.addDeltaToChange(c,e,l.type)}for(let h=0;h<i.length;h++){let l=i[h],u=this.privateStorage.get(l.type);u&&(u.value-=e*l.value)}}addDeltaToChange(e,s,i){if(this.isHighlighted)if(i){let n=this.publicStorageChange.get(i);n?(n[0]+=e,n[1]+=s,n[1]>=1&&(this.publicStoragePS.set(i,E(n[0],2)),n[0]=0,n[1]=0)):this.publicStorageChange.set(i,[e,s])}else for(let n=0;n<this.recipe.outputs.length;n++){let a=this.recipe.inputs[n],h=this.publicStorageChange.get(a.type);h?(h[0]+=e,h[1]+=s,h[1]>=1&&(this.publicStoragePS.set(a.type,E(h[0],2)),h[0]=0,h[1]=0)):this.publicStorageChange.set(a.type,[e,s])}}getRecipeInputFromNearbyBuildings(e){for(let s=0;s<this.recipe.inputs.length;s++){let i=this.recipe.inputs[s],n=this.privateStorage.get(i.type).value;if(!(n>=this.recipe.inputs[s].value))for(let a=0;a<e.length;a++){if(!(e[a]instanceof k))continue;let h=e[a].publicStorage.get(i.type);if(!h)continue;let l=Math.min(i.value,h.value);if(n+=l,h.value-=l,this.addDeltaToChange(-l,0,i.type),n>=i.value)break}}}toJSON(){return{q:this.q,r:this.r,s:this.s,type:this.type,level:this.level}}}class G{constructor(t,e,s,i,n){o(this,"type");o(this,"name");o(this,"value");o(this,"description");o(this,"icon");this.type=t,this.name=e,this.description=i,this.icon=n,this.value=s}clone(){return new G(this.type,this.name,this.value,this.description,this.icon)}}class at extends G{constructor(t=0){super("wood","Wood",t,"A piece of wood",'<img src="data:image/png;base64,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">')}}class Jt{constructor(t,e,s,i,n){o(this,"id");o(this,"name");o(this,"icon");o(this,"inputs");o(this,"outputs");this.id=t,this.name=e,this.icon=s,this.inputs=i??[],this.outputs=n??[]}}class Vt extends Jt{constructor(){super("wood","Wood","wood",[],[new at(0)])}}class Bt extends k{constructor(t,e=1,s){super("tree",t,"tree",e,1,!0,new Vt,void 0,new Map([["wood",new at(s)]]))}}class Q{constructor(t,e,s,i){o(this,"type");o(this,"name");o(this,"tiles");o(this,"description");this.type=t,this.name=e,this.tiles=s,this.description=i}clone(){return new Q(this.type,this.name,this.tiles,this.description)}}class Ot extends Q{constructor(){super("default","Default Tileset",[Bt],"A basic set of map tiles for testing and development purposes.")}}const qt=Object.freeze(Object.defineProperty({__proto__:null,default:Ot},Symbol.toStringTag,{value:"Module"}));function Pt(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var T={exports:{}},Tt=T.exports,_;function Ht(){return _||(_=1,function(r,t){(function(e,s){r.exports=s()})(Tt,function(){return e.importState=function(i){var n=new e;return n.importState(i),n},e;function e(){return function(i){var n=0,a=0,h=0,l=1;i.length==0&&(i=[+new Date]);var u=s();n=u(" "),a=u(" "),h=u(" ");for(var c=0;c<i.length;c++)n-=u(i[c]),n<0&&(n+=1),a-=u(i[c]),a<0&&(a+=1),h-=u(i[c]),h<0&&(h+=1);u=null;var g=function(){var f=2091639*n+l*23283064365386963e-26;return n=a,a=h,h=f-(l=f|0)};return g.next=g,g.uint32=function(){return g()*4294967296},g.fract53=function(){return g()+(g()*2097152|0)*11102230246251565e-32},g.version="Alea 0.9",g.args=i,g.exportState=function(){return[n,a,h,l]},g.importState=function(f){n=+f[0]||0,a=+f[1]||0,h=+f[2]||0,l=+f[3]||0},g}(Array.prototype.slice.call(arguments))}function s(){var i=4022871197,n=function(a){a=a.toString();for(var h=0;h<a.length;h++){i+=a.charCodeAt(h);var l=.02519603282416938*i;i=l>>>0,l-=i,l*=i,i=l>>>0,l-=i,i+=l*4294967296}return(i>>>0)*23283064365386963e-26};return n.version="Mash 0.9",n}})}(T)),T.exports}var Kt=Ht();const Ut=Pt(Kt),ht=Math.sqrt(3),Wt=.5*(ht-1),J=(3-ht)/6,$=r=>Math.floor(r)|0,tt=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]);function Rt(r=Math.random){const t=Yt(r),e=new Float64Array(t).map(i=>tt[i%12*2]),s=new Float64Array(t).map(i=>tt[i%12*2+1]);return function(n,a){let h=0,l=0,u=0;const c=(n+a)*Wt,g=$(n+c),f=$(a+c),x=(g+f)*J,A=g-x,v=f-x,m=n-A,S=a-v;let O,q;m>S?(O=1,q=0):(O=0,q=1);const K=m-O+J,U=S-q+J,W=m-1+2*J,R=S-1+2*J,Y=g&255,X=f&255;let w=.5-m*m-S*S;if(w>=0){const y=Y+t[X],C=e[y],I=s[y];w*=w,h=w*w*(C*m+I*S)}let M=.5-K*K-U*U;if(M>=0){const y=Y+O+t[X+q],C=e[y],I=s[y];M*=M,l=M*M*(C*K+I*U)}let b=.5-W*W-R*R;if(b>=0){const y=Y+1+t[X+1],C=e[y],I=s[y];b*=b,u=b*b*(C*W+I*R)}return 70*(h+l+u)}}function Yt(r){const e=new Uint8Array(512);for(let s=0;s<512/2;s++)e[s]=s;for(let s=0;s<512/2-1;s++){const i=s+~~(r()*(256-s)),n=e[s];e[s]=e[i],e[i]=n}for(let s=256;s<512;s++)e[s]=e[s-256];return e}const et=Math.sqrt(3),B=document.getElementById("game"),d=B.getContext("2d");d.imageSmoothingEnabled=!0;d.imageSmoothingQuality="high";j(B,d);addEventListener("resize",()=>j(B,d));function j(r,t){const e=innerWidth,s=innerHeight;r.width=e*window.devicePixelRatio,r.height=s*window.devicePixelRatio,r.style.width=e+"px",r.style.height=s+"px",t.scale(window.devicePixelRatio,window.devicePixelRatio)}function Xt(){d.clearRect(0,0,B.width,B.height)}function N(r,t,e,s){d.beginPath(),d.moveTo(r[0].x,r[0].y);for(let i=1;i<r.length;i++)d.lineTo(r[i].x,r[i].y);d.closePath(),t!==null&&(d.fillStyle=t,d.fill()),d.lineWidth=s,e!==null&&(d.strokeStyle=e),d.stroke()}function zt(r,t,e,s){d.drawImage(s,r.x-et*t/2,r.y-2*e/2,et*t,2*e)}function Dt(r,t,e){d.beginPath();for(let s=0;s<r.length;s++)d.moveTo(r[s][0].x,r[s][0].y),d.lineTo(r[s][1].x,r[s][1].y);d.fillStyle="blue",d.fill(),d.lineWidth=e,d.strokeStyle=t,d.stroke()}class p{constructor(t,e,s,i){o(this,"x");o(this,"y");o(this,"maxY");o(this,"minY");o(this,"maxX");o(this,"minX");this.x=t,this.y=e,this.maxX=s,this.maxY=s,this.minX=i,this.minY=i}add(t){return this.x=this.maxX?Math.min(this.x+t.x,this.maxX):this.x+t.x,this.y=this.maxY?Math.min(this.y+t.y,this.maxY):this.y+t.y,this.x=this.minX?Math.max(this.x,this.minX):this.x,this.y=this.minY?Math.max(this.y,this.minY):this.y,this}subtract(t){return this.x=this.minX?Math.max(this.x-t.x,this.minX):this.x-t.x,this.y=this.minY?Math.max(this.y-t.y,this.minY):this.y-t.y,this.x=this.maxX?Math.min(this.x,this.maxX):this.x,this.y=this.maxY?Math.min(this.y,this.maxY):this.y,this}multiply(t){return this.x*=t,this.y*=t,this}equal(t){return Math.round(this.x)===Math.round(t.x)&&Math.round(this.y)===Math.round(t.y)}greaterThan(t){return this.x>t.x&&this.y>t.y}lessThan(t){return this.x<t.x&&this.y<t.y}difference(t){return new p(Math.abs(this.x-t.x),Math.abs(this.y-t.y))}toString(){return`(${this.x}, ${this.y})`}clone(){return new p(this.x,this.y,this.maxX,this.minX)}toJSON(){let t={x:this.x,y:this.y};return this.maxX&&(t.max=this.maxX),this.minX&&(t.min=this.minX),t}}class Et{constructor(t="HexFactory",e){o(this,"hexagons",new Map);o(this,"seed");o(this,"directions",[{q:1,r:0,s:-1},{q:1,r:-1,s:0},{q:0,r:-1,s:1},{q:-1,r:0,s:1},{q:-1,r:1,s:0},{q:0,r:1,s:-1}]);o(this,"PI2",Math.PI*2);o(this,"anglesCosSin",[new p(Math.cos(this.PI2*.5/6),Math.sin(this.PI2*.5/6)),new p(Math.cos(this.PI2*-.5/6),Math.sin(this.PI2*-.5/6)),new p(Math.cos(this.PI2*-1.5/6),Math.sin(this.PI2*-1.5/6)),new p(Math.cos(this.PI2*-2.5/6),Math.sin(this.PI2*-2.5/6)),new p(Math.cos(this.PI2*-3.5/6),Math.sin(this.PI2*-3.5/6)),new p(Math.cos(this.PI2*-4.5/6),Math.sin(this.PI2*-4.5/6))]);o(this,"hexPositionCache",new Map);o(this,"hexRingCache",new Map);this.seed=t,this.hexagons=e}getCachedHexPosition(t,e){let s=this.hexPositionCache.get(t.id);if(s!==void 0)return s;let i=this.polygonCorners(e,t),n=this.hexToPixel(e,t);return this.hexPositionCache.set(t.id,[i,n]),[i,n]}update(t){this.hexagons.forEach(e=>{e.updateable&&e.update(t,this.range(e,e.range))})}draw(t){t.changed&&this.hexPositionCache.clear();let e=0;this.hexagons.forEach(s=>{let[i,n]=this.getCachedHexPosition(s,t);this.isHexInViewport(t,s,i)&&(e++,zt(n,t.size.x,t.size.y,s.image),N(i,null,"darkgray",1))}),console.log("drawn hexagons: "+e)}getHexagon(t){return this.hexagons.get(t)}getHexagonByCords(t){return this.hexagons.get(t.q+"_"+t.r+"_"+t.s)}replaceBuilding(t){this.hexagons.set(t.id,t)}axialToCube(t){const e=t.x,s=t.y,i=-e-s;return{q:e,r:s,s:i}}cubeToAxial(t){const e=t.q,s=t.r;return new p(e,s)}add(t,e,s=!1){let i=this.getHexagonByCords({q:t.q+e.q,r:t.r+e.r,s:t.s+e.s});return!i&&s&&(i=new P(t.q+e.q,t.r+e.r,t.s+e.s,!1)),i}subtract(t,e,s=!1){let i=this.getHexagonByCords({q:t.q-e.q,r:t.r-e.r,s:t.s-e.s});return!i&&s&&(i=new P(t.q-e.q,t.r-e.r,t.s-e.s,!1)),i}multiply(t,e,s=!1){let i=this.getHexagonByCords({q:t.q*e,r:t.r*e,s:t.s*e});return!i&&s&&(i=new P(t.q*e,t.r*e,t.s*e,!1)),i}equals(t,e){return t.q===e.q&&t.r===e.r&&t.s===e.s}length(t){return(Math.abs(t.q)+Math.abs(t.r)+Math.abs(t.s))/2}distance(t,e){let s=this.subtract(t,e);return s?this.length(s):1}getNeighbor(t,e,s=!1){return typeof e=="number"&&(e=this.directions[e]),this.add(t,e,s)}getNeighbors(t){let e=[];for(let s=0,i=this.directions.length;s<i;s++){let n=this.getNeighbor(t,s);e.push(n)}return e}isNeighbor(t,e){return this.distance(t,e)===1}ring(t,e){let s=this.hexRingCache.get(t.id+"_"+e);if(s!==void 0)return s;let i=[],n=this.add(t,this.multiply(this.directions[4],e,!0),!0);for(let a=0;a<6;a++)for(let h=0;h<e;h++)n.exists?(i.push(n),n=this.getNeighbor(n,a,!0)):n=this.getNeighbor(n,a,!0);return this.hexRingCache.set(t.id+"_"+e,i),i}range(t,e){let s=[];for(let i=0;i<=e;i++)s=s.concat(this.ring(t,i));return s}hexToPixel(t,e){const s=t.orientation,i=t.size,n=t.origin,a=(s.f0*e.q+s.f1*e.r)*i.x,h=(s.f2*e.q+s.f3*e.r)*i.y;return new p(a+n.x,h+n.y)}pixelToHex(t,e){const s=t.orientation,i=t.size,n=t.origin,a=new p((e.x-n.x)/i.x,(e.y-n.y)/i.y),h=s.b0*a.x+s.b1*a.y,l=s.b2*a.x+s.b3*a.y;return this.roundHex({q:h,r:l,s:-h-l})}roundHex(t){let e=Math.round(t.q),s=Math.round(t.r),i=Math.round(t.s);const n=Math.abs(e-t.q),a=Math.abs(s-t.r),h=Math.abs(i-t.s);return n>a&&n>h?e=-s-i:a>h?s=-e-i:i=-e-s,this.getHexagonByCords({q:e,r:s,s:i})}hexCornerOffset(t,e){const s=t.size;return new p(s.x*this.anglesCosSin[e].x,s.y*this.anglesCosSin[e].y)}polygonCorners(t,e){const s=[],i=this.hexToPixel(t,e);for(let n=0;n<6;n++){const a=this.hexCornerOffset(t,n);s.push(a.add(i))}return s}isHexInViewport(t,e,s=null){s=s??this.polygonCorners(t,e);for(let i=0,n=s.length;i<n;i++)if(t.isVectorInViewport(s[i]))return!0;return!1}outlineHexGroup(t,e){let s=[];for(let i=0,n=e.length;i<n;i++){let a=e[i],h=this.getNeighbors(a);for(let l=0,u=h.length;l<u;l++){let c=h[l];if(!c||e.indexOf(c)===-1){let g=this.hexToPixel(t,a),f=this.hexCornerOffset(t,l),x=this.hexCornerOffset(t,(l+1)%6),A=new p(g.x+f.x,g.y+f.y),v=new p(g.x+x.x,g.y+x.y);s.push([A,v])}}}return s}toJSON(){return{hexagons:this.hexagons,seed:this.seed}}}const st=Object.assign({"./maps/default.ts":qt}),lt={};for(const r in st){const t=r.match(/\.\/maps\/(.*)\.ts$/);if(!t){console.warn(`Could not extract name from path: ${r}`);continue}const e=t[1];lt[e]=st[r].default}function Nt(r="default",t=10,e=""){const s=lt[r];if(!s)throw new Error(`Tileset "${r}" not found.`);let n=new s().tiles;if(!n||n.length===0)throw new Error(`Tileset "${r}" does not have any start buildings defined.`);let a=n.length,h=Ut(e),l=Rt(h),u=new Map;for(let c=-t;c<=t;c++){const g=Math.max(-t,-c-t),f=Math.min(t,-c+t);for(let x=g;x<=f;x++){const A=Math.floor(Math.abs(l(c,x))*a)%a,v=n[A];u.set(c+"_"+x+"_"+(-c-x),new v({q:c,r:x,s:-c-x}))}}return new Et(e,u)}function Zt(r,t){const e=JSON.stringify(t);localStorage.setItem(r,btoa(encodeURIComponent(e)))}function Lt(r){if(!localStorage.getItem(r))return;const t=decodeURIComponent(atob(localStorage.getItem(r)));return JSON.parse(t)}const Ft={layout:{maxSize:70,minSize:15}};let V=Ft;function kt(){let r=Lt("settings");return r&&(V=r),V}function it(r){if(r.includes(".")){const t=r.split(".");let e=V;for(let s=0;s<t.length;s++){const i=t[s];if(e[i]===void 0)return;e=e[i]}return e}return V[r]}function Gt(r){const{game:t}=r;t.canvas.addEventListener("pointerup",e=>t.tapUp({x:e.clientX,y:e.clientY})),t.canvas.addEventListener("pointerdown",e=>t.tapDown({x:e.clientX,y:e.clientY})),t.canvas.addEventListener("pointermove",e=>{t.tapMove({x:e.movementX,y:e.movementY})}),t.canvas.addEventListener("wheel",e=>t.zoom(new p(e.deltaY*-1/50,e.deltaY*-1/50))),document.addEventListener("keydown",e=>{e.ctrlKey&&t.layout.reset()})}const D=Math.sqrt(3),Qt={f0:D,f1:D/2,f2:0,f3:3/2,b0:D/3,b1:-1/3,b2:0,b3:2/3,startAngle:.5};class jt{constructor(t,e,s,i){o(this,"orientation");o(this,"size");o(this,"origin");o(this,"viewport");o(this,"changed",!0);o(this,"center");this.orientation=t,this.size=new p(e.x,e.y,s,i);let n=window.innerWidth,a=window.innerHeight;this.origin=new p(n/2,a/2),this.viewport=new p(n,a),this.center=new p(n/2,a/2)}setOrientation(t){this.changed=!0,this.orientation=t}isVectorInViewport(t){return t.greaterThan({x:-10,y:-10})&&t.lessThan({x:this.viewport.x+10,y:this.viewport.y+10})}setOrigin(t,e=!1){this.changed=!0,e?this.origin.add(t):this.origin=t}reset(){this.changed=!0,this.origin=this.center.clone(),this.viewport=new p(window.innerWidth,window.innerHeight)}setSize(t,e=!1){this.changed=!0,e?this.size.add(t):this.size=t}toJSON(){return{origin:this.origin,size:this.size}}}class _t{constructor(t){o(this,"initSteps");o(this,"step",0);o(this,"loadingScreen");o(this,"loadingText");o(this,"loadingProgress");this.initSteps=t,this.loadingScreen=document.querySelector("#loadingScreen"),this.loadingText=document.querySelector("#loadingText"),this.loadingProgress=document.querySelector("#loadingProgress")}stepLoadingScreen(t,e){if(this.step===0&&(this.loadingProgress.max=this.initSteps),this.step+=t,this.step>=this.initSteps){this.loadingScreen.style.display="none";return}this.loadingProgress.value=this.step,this.loadingText.innerHTML=e}}const $t="↗︎",te="↘︎";let Z=!1,H,L,F;function ee(){Z||(H=document.getElementById("stats"),Z=!0)}function se(r,t){if(!Z)throw Error("UI not initialized");L=r,F=t;let e="";r.forEach(s=>{e+=`<div class="stat" id="${s.type}">
            <div class="stat-figure text-secondary">
                ${s.icon}
            </div>
            <div class="stat-title">${s.name}</div>
            <div class="stat-value">${dt(s.value,2)}</div>
            <div class="stat-desc">${ct(s.type)}</div>
        </div>`}),H.innerHTML=e}function ie(){L&&L.forEach(r=>{let t=H.querySelector("#"+r.type+" .stat-value"),e=H.querySelector("#"+r.type+" .stat-desc");!t||!e||(t.innerHTML=E(r.value,2).toString(),e.innerHTML=ct(r.type))})}function ct(r){if(!F)return"";let t=F.get(r),e="";return t===void 0?e="...":e=(pt(t)?$t:te)+" "+t.toString(),e}const ne=59,nt=1e3/ne,re=10,rt=1e3/re,oe=4,ot=1e3/oe;class ae{constructor(){o(this,"canvas",document.querySelector("#game"));o(this,"ctx",this.canvas.getContext("2d"));o(this,"layout");o(this,"hexMap");o(this,"FPSOldTimeStamp",0);o(this,"UPSOldTimeStamp",0);o(this,"UIPSOldTimeStamp",0);o(this,"tapedHex");o(this,"highlightedHex");o(this,"tap",0);let t=new _t(15);kt(),t.stepLoadingScreen(5,"Loading settings"),this.layout=new jt(Qt,new p(20,20),it("layout.maxSize"),it("layout.minSize")),t.stepLoadingScreen(1,"Layout"),ee(),t.stepLoadingScreen(1,"noise"),this.hexMap=Nt(),Gt({game:this}),t.stepLoadingScreen(15,"start"),this.init()}init(){j(document.querySelector("#game"),document.querySelector("#game").getContext("2d")),this.gameLoop(0)}draw(){if(this.hexMap.draw(this.layout),this.highlightedHex){let t=this.hexMap.range(this.highlightedHex,1);Dt(this.hexMap.outlineHexGroup(this.layout,t),"darkgreen",2);for(let e of t)N(this.hexMap.polygonCorners(this.layout,e),"rgba(0, 200, 0, 0.5)","rgba(0, 0, 200, 0)",1);N(this.hexMap.polygonCorners(this.layout,this.highlightedHex),"rgba(0, 0, 200, 0.5)","rgba(0, 0, 200, 0)",1)}}gameLoop(t){let e=t-this.FPSOldTimeStamp,s=t-this.UPSOldTimeStamp,i=t-this.UIPSOldTimeStamp;e>nt&&(Xt(),this.draw(),this.FPSOldTimeStamp=t-e%nt,this.layout.changed=!1),s>rt&&(this.UPSOldTimeStamp=t-s%rt,this.update(s/1e3)),i>ot&&(this.UIPSOldTimeStamp=t-i%ot,ie()),window.requestAnimationFrame(n=>this.gameLoop(n))}update(t){this.hexMap.update(t)}async save(){let t={layout:this.layout,hexMap:this.hexMap};Zt("save",t)}async load(){}zoom(t){let e=this.hexMap.pixelToHex(this.layout,this.layout.center);if(this.layout.setSize(t,!0),e){let s=this.hexMap.hexToPixel(this.layout,e);this.layout.setOrigin({x:this.layout.center.x-s.x,y:this.layout.center.y-s.y},!0)}}async tapDown(t){this.tap=performance.now(),t&&(this.layout.changed=!0,this.tapedHex&&(this.tapedHex.isHighlighted=!1),this.tapedHex=this.hexMap.pixelToHex(this.layout,t),this.tapedHex.isHighlighted=!0)}async tapUp(t){if(this.tap=0,!this.tapedHex)return;this.highlightedHex=this.tapedHex;let e=this.hexMap.hexToPixel(this.layout,this.tapedHex);this.layout.setOrigin({x:this.layout.center.x-e.x,y:this.layout.center.y-e.y},!0),se(this.tapedHex.publicStorage,this.tapedHex.publicStoragePS)}async tapMove(t){this.tap&&t&&(this.layout.setOrigin({x:t.x,y:t.y},!0),!(performance.now()-this.tap<100)&&(this.tapedHex=void 0))}debug(){}}addEventListener("load",()=>new ae);
